(()=>{"use strict";const e=document.getElementById("task-template"),t=document.querySelector(".btn-delete-project"),n=document.querySelector(".btn-delete-complete"),d=document.querySelector(".btn-new-project"),l=document.querySelector("#btn-add-task"),a=document.querySelector(".edit-task-title-input"),o=document.querySelector(".edit-task-date"),i=document.querySelector(".edit-task-details"),s=document.getElementsByName("edit-priority");function c(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function r(e,t){const n=e.tasks.filter((e=>!e.complete)).length,d=1===n?"task":"tasks";t.innerText=`${n} ${d} remaining`}function u(e){const a=document.querySelector(".edit-task-container"),o=document.querySelector(".newtask");a.classList.add("edit-not-active"),o.classList.remove("new-not-active"),function(){t.disabled=!1,n.disabled=!1,d.disabled=!1,l.disabled=!1,document.querySelectorAll(".btn-task-delete").forEach((e=>e.disabled=!1));let e=document.getElementsByTagName("input");for(let t=0;t<e.length;t++)"checkbox"==e[t].type&&(e[t].disabled=!1)}(),e.classList.remove("project-list-none")}const m=document.querySelector(".project-list"),p=document.querySelector("[data-new-project-form]"),k=document.querySelector(".new-project-input"),y=document.querySelector(".btn-delete-project"),f=document.querySelector(".todo-content"),S=document.querySelector(".todo-title"),v=document.querySelector(".task-count"),g=document.querySelector(".all-tasks"),q=document.querySelector(".btn-delete-complete"),b=document.querySelector(".new-task-form"),L=document.querySelector(".new-task-title-input"),h=document.querySelector(".new-task-date"),w=document.querySelector(".new-task-details"),E=document.getElementsByName("create-new-priority"),j=document.querySelector(".edit-task-form"),N=document.querySelector(".edit-task-title-input"),I=document.querySelector(".edit-task-date"),D=document.querySelector(".edit-task-details"),B=document.getElementsByName("edit-priority");let C=JSON.parse(localStorage.getItem("project.lists"))||[],x=localStorage.getItem("project.selectedListId"),T="";function A(){localStorage.setItem("project.lists",JSON.stringify(C)),localStorage.setItem("project.selectedListId",x)}function J(){c(m),function(e,t,n){e.forEach((e=>{const d=document.createElement("li");d.dataset.projId=e.id,d.classList.add("project-list-name"),d.innerText=e.name,e.id===t&&d.classList.add("active-project"),n.appendChild(d)}))}(C,x,m);const t=C.find((e=>e.id===x));"null"==x||null===x?f.style.display="none":(f.style.display="",S.innerText=t.name,r(t,v),c(g),function(t,n){t.tasks.forEach((t=>{const d=document.importNode(e.content,!0),l=d.querySelector(".task-row");"low"==t.priority?l.classList.add("task-low"):"medium"==t.priority?l.classList.add("task-medium"):l.classList.add("task-high");const a=d.querySelector("input");a.id=t.id,a.checked=t.complete;const o=d.querySelector("label");o.htmlFor=t.id,o.append(t.name),d.querySelector(".task-date").append(t.dueDate),d.querySelector(".task-priority").append(t.priority),d.querySelector(".task-notes").append(t.notes),d.querySelector(".btn-task-details").id="details-"+t.id,d.querySelector(".btn-task-edit").id="edit-"+t.id,d.querySelector(".btn-task-delete").id="delete-"+t.id,d.querySelector(".task-details-row").id="row-"+t.id,n.appendChild(d)}))}(t,g))}m.addEventListener("click",(e=>{"li"===e.target.tagName.toLowerCase()&&(x=e.target.dataset.projId,A(),J())})),g.addEventListener("click",(e=>{if("input"===e.target.tagName.toLowerCase()){const t=C.find((e=>e.id===x));t.tasks.find((t=>t.id===e.target.id)).complete=e.target.checked,A(),r(t,v)}})),q.addEventListener("click",(e=>{let t=C.find((e=>e.id===x));0===t.tasks.filter((e=>e.complete)).length?alert("No completed task to delete"):(t=C.find((e=>e.id===x)),t.tasks=t.tasks.filter((e=>!e.complete)),A(),J())})),g.addEventListener("click",(e=>{if(e.target.classList.contains("btn-task-details")){const t=e.target.id.split("-");document.getElementById("row-"+t[1]).classList.toggle("active-details")}})),g.addEventListener("click",(e=>{if(e.target.classList.contains("btn-task-edit")){!function(){t.disabled=!0,n.disabled=!0,d.disabled=!0,l.disabled=!0,document.querySelectorAll(".btn-task-delete").forEach((e=>e.disabled=!0));let e=document.getElementsByTagName("input");for(let t=0;t<e.length;t++)"checkbox"==e[t].type&&(e[t].disabled=!0)}();let c=e.target.id.split("-");T=c[1];const r=C.find((e=>e.id===x));!function(e,t){t.classList.add("project-list-none");const n=document.querySelector(".edit-task-container"),d=document.querySelector(".newtask");n.classList.remove("edit-not-active"),d.classList.add("new-not-active"),a.value=e.name,i.value=e.notes,o.value=e.dueDate;for(let t=0;t<s.length;t++)s[t].value==e.priority&&(s[t].checked=!0)}(r.tasks.find((e=>e.id===T)),m),j.addEventListener("submit",(e=>{e.preventDefault();const t=N.value,n=I.value,d=D.value;let l="";for(let e=0;e<B.length;e++)B[e].checked&&(l=B[e].value);let a=r.tasks.find((e=>e.id===T));a.name=t,a.notes=d,a.dueDate=n,a.priority=l,A(),u(m),J()})),document.querySelector("#btn-cancel-edit-task").addEventListener("click",(()=>{u(m)}))}})),g.addEventListener("click",(e=>{if(e.target.classList.contains("btn-task-delete")){let t=e.target.id.split("-")[1];const n=C.find((e=>e.id===x));n.tasks=n.tasks.filter((e=>e.id!==t)),A(),J()}})),y.addEventListener("click",(e=>{C=C.filter((e=>e.id!==x)),x=null,A(),J()})),p.addEventListener("submit",(e=>{e.preventDefault();const t=(n=k.value,{id:Date.now().toString(),name:n,tasks:[]});var n;k.value=null,C.push(t),A(),J()})),b.addEventListener("submit",(e=>{if(e.preventDefault(),"null"==x||null===x)return void alert("Please select a project to add the new task.");const t=L.value,n=h.value,d=w.value;let l="";for(let e=0;e<E.length;e++)E[e].checked&&(l=E[e].value);if(null==t||""===t)return;const a=(o=t,i=d,s=n,c=l,{id:Date.now().toString(),name:o,complete:!1,dueDate:s,notes:i,priority:c});var o,i,s,c;L.value=null,w.value=null,C.find((e=>e.id===x)).tasks.push(a),A(),J()})),J()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB0YXNrVGVtcGxhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRhc2stdGVtcGxhdGVcIik7XG5jb25zdCBkZWxldGVQcm9qZWN0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5idG4tZGVsZXRlLXByb2plY3RcIik7XG5jb25zdCB0YXNrRGVsZXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5idG4tZGVsZXRlLWNvbXBsZXRlXCIpO1xuY29uc3QgbmV3UHJvamVjdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYnRuLW5ldy1wcm9qZWN0XCIpO1xuY29uc3QgbmV3VGFza0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYnRuLWFkZC10YXNrXCIpO1xuY29uc3QgZWRpdFRhc2tJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLXRpdGxlLWlucHV0XCIpO1xuY29uc3QgZWRpdFRhc2tEYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LXRhc2stZGF0ZVwiKTtcbmNvbnN0IGVkaXRUYXNrTm90ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLWRldGFpbHNcIik7XG5jb25zdCBlZGl0VGFza1ByaW9yaXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoXCJlZGl0LXByaW9yaXR5XCIpO1xuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJFbGVtZW50KGVsZW1lbnQpIHtcbiAgd2hpbGUgKGVsZW1lbnQuZmlyc3RDaGlsZCkge1xuICAgIGVsZW1lbnQucmVtb3ZlQ2hpbGQoZWxlbWVudC5maXJzdENoaWxkKTtcbiAgfVxufVxuXG4vL2NyZWF0ZSBuZXcgcHJvamVjdFxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByb2plY3QobmFtZSkge1xuICByZXR1cm4ge1xuICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXG4gICAgbmFtZTogbmFtZSxcbiAgICB0YXNrczogW10sXG4gIH07XG59XG5cbi8vY3JlYXRlIG5ldyB0YXNrXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVGFzayhuYW1lLCBub3RlcywgZGF0ZSwgcHJpb3JpdHkpIHtcbiAgcmV0dXJuIHtcbiAgICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxuICAgIG5hbWU6IG5hbWUsXG4gICAgY29tcGxldGU6IGZhbHNlLFxuICAgIGR1ZURhdGU6IGRhdGUsXG4gICAgbm90ZXM6IG5vdGVzLFxuICAgIHByaW9yaXR5OiBwcmlvcml0eSxcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclByb2plY3RMaXN0cyhcbiAgcHJvamVjdHMsXG4gIHNlbGVjdGVkUHJvamVjdElkLFxuICBwcm9qZWN0Q29udGFpbmVyXG4pIHtcbiAgLy9yZW5kZXIgZWFjaCBwcm9qZWN0XG4gIHByb2plY3RzLmZvckVhY2goKHByb2plY3QpID0+IHtcbiAgICBjb25zdCBwcm9qRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcblxuICAgIHByb2pFbGVtZW50LmRhdGFzZXQucHJvaklkID0gcHJvamVjdC5pZDtcbiAgICBwcm9qRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC1saXN0LW5hbWVcIik7XG4gICAgcHJvakVsZW1lbnQuaW5uZXJUZXh0ID0gcHJvamVjdC5uYW1lO1xuXG4gICAgaWYgKHByb2plY3QuaWQgPT09IHNlbGVjdGVkUHJvamVjdElkKSB7XG4gICAgICBwcm9qRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlLXByb2plY3RcIik7XG4gICAgfVxuXG4gICAgcHJvamVjdENvbnRhaW5lci5hcHBlbmRDaGlsZChwcm9qRWxlbWVudCk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyVGFza0NvdW50KHNlbGVjdGVkUHJvamVjdCwgdGFza3NDb3VudEVsZW1lbnQpIHtcbiAgY29uc3QgaW5jb21wbGV0ZVRhc2tDb3VudCA9IHNlbGVjdGVkUHJvamVjdC50YXNrcy5maWx0ZXIoXG4gICAgKHRhc2spID0+ICF0YXNrLmNvbXBsZXRlXG4gICkubGVuZ3RoO1xuICBjb25zdCB0YXNrU3RyaW5nID0gaW5jb21wbGV0ZVRhc2tDb3VudCA9PT0gMSA/IFwidGFza1wiIDogXCJ0YXNrc1wiO1xuICB0YXNrc0NvdW50RWxlbWVudC5pbm5lclRleHQgPSBgJHtpbmNvbXBsZXRlVGFza0NvdW50fSAke3Rhc2tTdHJpbmd9IHJlbWFpbmluZ2A7XG59XG5cbi8vcmVuZGVyIHRhc2tcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJUYXNrcyhzZWxlY3RlZFByb2plY3QsIHRhc2tzQ29udGFpbmVyKSB7XG4gIHNlbGVjdGVkUHJvamVjdC50YXNrcy5mb3JFYWNoKCh0YXNrKSA9PiB7XG4gICAgY29uc3QgdGFza0VsZW1lbnQgPSBkb2N1bWVudC5pbXBvcnROb2RlKHRhc2tUZW1wbGF0ZS5jb250ZW50LCB0cnVlKTtcblxuICAgIGNvbnN0IHRhc2tSb3cgPSB0YXNrRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhc2stcm93XCIpO1xuXG4gICAgaWYgKHRhc2sucHJpb3JpdHkgPT0gXCJsb3dcIikge1xuICAgICAgdGFza1Jvdy5jbGFzc0xpc3QuYWRkKFwidGFzay1sb3dcIik7XG4gICAgfSBlbHNlIGlmICh0YXNrLnByaW9yaXR5ID09IFwibWVkaXVtXCIpIHtcbiAgICAgIHRhc2tSb3cuY2xhc3NMaXN0LmFkZChcInRhc2stbWVkaXVtXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0YXNrUm93LmNsYXNzTGlzdC5hZGQoXCJ0YXNrLWhpZ2hcIik7XG4gICAgfVxuXG4gICAgY29uc3QgY2hlY2tib3ggPSB0YXNrRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRcIik7XG4gICAgY2hlY2tib3guaWQgPSB0YXNrLmlkO1xuICAgIGNoZWNrYm94LmNoZWNrZWQgPSB0YXNrLmNvbXBsZXRlO1xuXG4gICAgY29uc3QgbGFiZWwgPSB0YXNrRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwibGFiZWxcIik7XG4gICAgbGFiZWwuaHRtbEZvciA9IHRhc2suaWQ7XG4gICAgbGFiZWwuYXBwZW5kKHRhc2submFtZSk7XG5cbiAgICBjb25zdCBkYXRlID0gdGFza0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLWRhdGVcIik7XG4gICAgZGF0ZS5hcHBlbmQodGFzay5kdWVEYXRlKTtcblxuICAgIGNvbnN0IHByaW9yaXR5ID0gdGFza0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLXByaW9yaXR5XCIpO1xuICAgIHByaW9yaXR5LmFwcGVuZCh0YXNrLnByaW9yaXR5KTtcblxuICAgIGNvbnN0IG5vdGVzID0gdGFza0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLW5vdGVzXCIpO1xuICAgIG5vdGVzLmFwcGVuZCh0YXNrLm5vdGVzKTtcblxuICAgIGNvbnN0IGRldGFpbHNCdXR0b24gPSB0YXNrRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmJ0bi10YXNrLWRldGFpbHNcIik7XG4gICAgZGV0YWlsc0J1dHRvbi5pZCA9IFwiZGV0YWlscy1cIiArIHRhc2suaWQ7XG5cbiAgICBjb25zdCBlZGl0QnV0dG9uID0gdGFza0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5idG4tdGFzay1lZGl0XCIpO1xuICAgIGVkaXRCdXR0b24uaWQgPSBcImVkaXQtXCIgKyB0YXNrLmlkO1xuXG4gICAgY29uc3QgZGVsZXRlQnV0dG9uID0gdGFza0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5idG4tdGFzay1kZWxldGVcIik7XG4gICAgZGVsZXRlQnV0dG9uLmlkID0gXCJkZWxldGUtXCIgKyB0YXNrLmlkO1xuXG4gICAgY29uc3QgZGV0YWlsc1JvdyA9IHRhc2tFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1kZXRhaWxzLXJvd1wiKTtcbiAgICBkZXRhaWxzUm93LmlkID0gXCJyb3ctXCIgKyB0YXNrLmlkO1xuXG4gICAgdGFza3NDb250YWluZXIuYXBwZW5kQ2hpbGQodGFza0VsZW1lbnQpO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpc2FibGVNb2RlKCkge1xuICBkZWxldGVQcm9qZWN0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgdGFza0RlbGV0ZUJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIG5ld1Byb2plY3RCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICBuZXdUYXNrQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcblxuICBsZXQgZGVsZXRlVGFza0J1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJ0bi10YXNrLWRlbGV0ZVwiKTtcbiAgZGVsZXRlVGFza0J1dHRvbnMuZm9yRWFjaCgoYnRuKSA9PiAoYnRuLmRpc2FibGVkID0gdHJ1ZSkpO1xuXG4gIGxldCBjaGVja2JveCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIik7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2hlY2tib3gubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoY2hlY2tib3hbaV0udHlwZSA9PSBcImNoZWNrYm94XCIpIHtcbiAgICAgIGNoZWNrYm94W2ldLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZW5hYmxlTW9kZSgpIHtcbiAgZGVsZXRlUHJvamVjdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB0YXNrRGVsZXRlQnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIG5ld1Byb2plY3RCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgbmV3VGFza0J1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuXG4gIGxldCBkZWxldGVUYXNrQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnRuLXRhc2stZGVsZXRlXCIpO1xuICBkZWxldGVUYXNrQnV0dG9ucy5mb3JFYWNoKChidG4pID0+IChidG4uZGlzYWJsZWQgPSBmYWxzZSkpO1xuXG4gIGxldCBjaGVja2JveCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIik7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2hlY2tib3gubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoY2hlY2tib3hbaV0udHlwZSA9PSBcImNoZWNrYm94XCIpIHtcbiAgICAgIGNoZWNrYm94W2ldLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlZGl0TW9kZShzZWxlY3RlZFRhc2ssIHByb2plY3RDb250YWluZXIpIHtcbiAgcHJvamVjdENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC1saXN0LW5vbmVcIik7XG5cbiAgY29uc3QgZWRpdENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLWNvbnRhaW5lclwiKTtcbiAgY29uc3QgbmV3Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5uZXd0YXNrXCIpO1xuXG4gIGVkaXRDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImVkaXQtbm90LWFjdGl2ZVwiKTtcbiAgbmV3Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJuZXctbm90LWFjdGl2ZVwiKTtcblxuICAvL3BvcHVsYXRlIHdpdGggZWRpdCBpbnB1dHNcbiAgZWRpdFRhc2tJbnB1dC52YWx1ZSA9IHNlbGVjdGVkVGFzay5uYW1lO1xuICBlZGl0VGFza05vdGUudmFsdWUgPSBzZWxlY3RlZFRhc2subm90ZXM7XG4gIGVkaXRUYXNrRGF0ZS52YWx1ZSA9IHNlbGVjdGVkVGFzay5kdWVEYXRlO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZWRpdFRhc2tQcmlvcml0eS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChlZGl0VGFza1ByaW9yaXR5W2ldLnZhbHVlID09IHNlbGVjdGVkVGFzay5wcmlvcml0eSkge1xuICAgICAgZWRpdFRhc2tQcmlvcml0eVtpXS5jaGVja2VkID0gdHJ1ZTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4aXRFZGl0TW9kZShwcm9qZWN0Q29udGFpbmVyKSB7XG4gIGNvbnN0IGVkaXRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtdGFzay1jb250YWluZXJcIik7XG4gIGNvbnN0IG5ld0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV3dGFza1wiKTtcblxuICBlZGl0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJlZGl0LW5vdC1hY3RpdmVcIik7XG4gIG5ld0NvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwibmV3LW5vdC1hY3RpdmVcIik7XG5cbiAgZW5hYmxlTW9kZSgpO1xuXG4gIHByb2plY3RDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcInByb2plY3QtbGlzdC1ub25lXCIpO1xufVxuIiwiaW1wb3J0IHtcbiAgY2xlYXJFbGVtZW50LFxuICBjcmVhdGVQcm9qZWN0LFxuICBjcmVhdGVUYXNrLFxuICByZW5kZXJQcm9qZWN0TGlzdHMsXG4gIHJlbmRlclRhc2tDb3VudCxcbiAgcmVuZGVyVGFza3MsXG4gIGRpc2FibGVNb2RlLFxuICBleGl0RWRpdE1vZGUsXG4gIGVkaXRNb2RlLFxufSBmcm9tIFwiLi90b2RvXCI7XG5cbmNvbnN0IHByb2plY3RDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtbGlzdFwiKTtcbmNvbnN0IG5ld1Byb2plY3RGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltkYXRhLW5ldy1wcm9qZWN0LWZvcm1dXCIpO1xuY29uc3QgbmV3UHJvamVjdElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5uZXctcHJvamVjdC1pbnB1dFwiKTtcbmNvbnN0IGRlbGV0ZVByb2plY3RCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmJ0bi1kZWxldGUtcHJvamVjdFwiKTtcblxuY29uc3QgcHJvamVjdERpc3BsYXlDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tY29udGVudFwiKTtcbmNvbnN0IHByb2plY3RUaXRsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tdGl0bGVcIik7XG5jb25zdCB0YXNrc0NvdW50RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1jb3VudFwiKTtcbmNvbnN0IHRhc2tzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hbGwtdGFza3NcIik7XG5jb25zdCB0YXNrRGVsZXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5idG4tZGVsZXRlLWNvbXBsZXRlXCIpO1xuXG5jb25zdCBuZXdUYXNrRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV3LXRhc2stZm9ybVwiKTtcbmNvbnN0IG5ld1Rhc2tJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV3LXRhc2stdGl0bGUtaW5wdXRcIik7XG5jb25zdCBuZXdUYXNrRGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV3LXRhc2stZGF0ZVwiKTtcbmNvbnN0IG5ld1Rhc2tOb3RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5uZXctdGFzay1kZXRhaWxzXCIpO1xuY29uc3QgbmV3VGFza1ByaW9yaXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoXCJjcmVhdGUtbmV3LXByaW9yaXR5XCIpO1xuXG5jb25zdCBlZGl0VGFza0Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtdGFzay1mb3JtXCIpO1xuY29uc3QgZWRpdFRhc2tJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLXRpdGxlLWlucHV0XCIpO1xuY29uc3QgZWRpdFRhc2tEYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LXRhc2stZGF0ZVwiKTtcbmNvbnN0IGVkaXRUYXNrTm90ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLWRldGFpbHNcIik7XG5jb25zdCBlZGl0VGFza1ByaW9yaXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoXCJlZGl0LXByaW9yaXR5XCIpO1xuXG5sZXQgcHJvamVjdHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwicHJvamVjdC5saXN0c1wiKSkgfHwgW107XG5sZXQgc2VsZWN0ZWRQcm9qZWN0SWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInByb2plY3Quc2VsZWN0ZWRMaXN0SWRcIik7XG5sZXQgaWRUb0VkaXQgPSBcIlwiO1xuXG4vL3VwZGF0ZSBzZWxlY3RlZCBwcm9qZWN0XG5wcm9qZWN0Q29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBpZiAoZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSBcImxpXCIpIHtcbiAgICBzZWxlY3RlZFByb2plY3RJZCA9IGUudGFyZ2V0LmRhdGFzZXQucHJvaklkO1xuXG4gICAgc2F2ZSgpO1xuICAgIHJlbmRlcigpO1xuICB9XG59KTtcblxuLy91cGRhdGUgaW5jb21wbGV0ZSB0YXNrIGNvdW50XG50YXNrc0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgaWYgKGUudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJpbnB1dFwiKSB7XG4gICAgY29uc3Qgc2VsZWN0ZWRQcm9qZWN0ID0gcHJvamVjdHMuZmluZChcbiAgICAgIChwcm9qZWN0KSA9PiBwcm9qZWN0LmlkID09PSBzZWxlY3RlZFByb2plY3RJZFxuICAgICk7XG4gICAgY29uc3Qgc2VsZWN0ZWRUYXNrID0gc2VsZWN0ZWRQcm9qZWN0LnRhc2tzLmZpbmQoXG4gICAgICAodGFzaykgPT4gdGFzay5pZCA9PT0gZS50YXJnZXQuaWRcbiAgICApO1xuICAgIHNlbGVjdGVkVGFzay5jb21wbGV0ZSA9IGUudGFyZ2V0LmNoZWNrZWQ7XG5cbiAgICBzYXZlKCk7XG4gICAgcmVuZGVyVGFza0NvdW50KHNlbGVjdGVkUHJvamVjdCwgdGFza3NDb3VudEVsZW1lbnQpO1xuICB9XG59KTtcblxuLy9kZWxldGUgYWxsIGNvbXBsZXRlZCB0YXNrc1xudGFza0RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgbGV0IHNlbGVjdGVkUHJvamVjdCA9IHByb2plY3RzLmZpbmQoXG4gICAgKHByb2plY3QpID0+IHByb2plY3QuaWQgPT09IHNlbGVjdGVkUHJvamVjdElkXG4gICk7XG4gIGNvbnN0IGNvbXBsZXRlZFRhc2tDb3VudCA9IHNlbGVjdGVkUHJvamVjdC50YXNrcy5maWx0ZXIoXG4gICAgKHRhc2spID0+IHRhc2suY29tcGxldGVcbiAgKS5sZW5ndGg7XG5cbiAgaWYgKGNvbXBsZXRlZFRhc2tDb3VudCA9PT0gMCkge1xuICAgIGFsZXJ0KFwiTm8gY29tcGxldGVkIHRhc2sgdG8gZGVsZXRlXCIpO1xuICB9IGVsc2Uge1xuICAgIHNlbGVjdGVkUHJvamVjdCA9IHByb2plY3RzLmZpbmQoXG4gICAgICAocHJvamVjdCkgPT4gcHJvamVjdC5pZCA9PT0gc2VsZWN0ZWRQcm9qZWN0SWRcbiAgICApO1xuICAgIHNlbGVjdGVkUHJvamVjdC50YXNrcyA9IHNlbGVjdGVkUHJvamVjdC50YXNrcy5maWx0ZXIoXG4gICAgICAodGFzaykgPT4gIXRhc2suY29tcGxldGVcbiAgICApO1xuXG4gICAgc2F2ZSgpO1xuICAgIHJlbmRlcigpO1xuICB9XG59KTtcblxuLy9vcGVuIHNwZWNpZmljIHRhc2sgZGV0YWlsc1xudGFza3NDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJidG4tdGFzay1kZXRhaWxzXCIpKSB7XG4gICAgY29uc3QgaWQgPSBlLnRhcmdldC5pZC5zcGxpdChcIi1cIik7XG4gICAgY29uc3QgZGV0YWlscyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicm93LVwiICsgaWRbMV0pO1xuXG4gICAgZGV0YWlscy5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlLWRldGFpbHNcIik7XG4gIH1cbn0pO1xuXG4vL29wZW4gc3BlY2lmaWMgZWRpdCBkZXRhaWxzXG50YXNrc0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImJ0bi10YXNrLWVkaXRcIikpIHtcbiAgICBkaXNhYmxlTW9kZSgpO1xuXG4gICAgbGV0IGlkQXJyID0gZS50YXJnZXQuaWQuc3BsaXQoXCItXCIpO1xuICAgIGlkVG9FZGl0ID0gaWRBcnJbMV07XG5cbiAgICBjb25zdCBzZWxlY3RlZFByb2plY3QgPSBwcm9qZWN0cy5maW5kKFxuICAgICAgKHByb2plY3QpID0+IHByb2plY3QuaWQgPT09IHNlbGVjdGVkUHJvamVjdElkXG4gICAgKTtcbiAgICBsZXQgc2VsZWN0ZWRUYXNrID0gc2VsZWN0ZWRQcm9qZWN0LnRhc2tzLmZpbmQoXG4gICAgICAodGFzaykgPT4gdGFzay5pZCA9PT0gaWRUb0VkaXRcbiAgICApO1xuXG4gICAgZWRpdE1vZGUoc2VsZWN0ZWRUYXNrLCBwcm9qZWN0Q29udGFpbmVyKTtcblxuICAgIC8vc3VibWl0IGVkaXQgZGV0YWlsc1xuICAgIGVkaXRUYXNrRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIGNvbnN0IHRhc2tOYW1lID0gZWRpdFRhc2tJbnB1dC52YWx1ZTtcbiAgICAgIGNvbnN0IHRhc2tEYXRlID0gZWRpdFRhc2tEYXRlLnZhbHVlO1xuICAgICAgY29uc3QgdGFza05vdGUgPSBlZGl0VGFza05vdGUudmFsdWU7XG5cbiAgICAgIGxldCB0YXNrUHJpb3JpdHkgPSBcIlwiO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVkaXRUYXNrUHJpb3JpdHkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGVkaXRUYXNrUHJpb3JpdHlbaV0uY2hlY2tlZCkge1xuICAgICAgICAgIHRhc2tQcmlvcml0eSA9IGVkaXRUYXNrUHJpb3JpdHlbaV0udmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbGV0IHNlbGVjdGVkVGFzayA9IHNlbGVjdGVkUHJvamVjdC50YXNrcy5maW5kKFxuICAgICAgICAodGFzaykgPT4gdGFzay5pZCA9PT0gaWRUb0VkaXRcbiAgICAgICk7XG5cbiAgICAgIHNlbGVjdGVkVGFzay5uYW1lID0gdGFza05hbWU7XG4gICAgICBzZWxlY3RlZFRhc2subm90ZXMgPSB0YXNrTm90ZTtcbiAgICAgIHNlbGVjdGVkVGFzay5kdWVEYXRlID0gdGFza0RhdGU7XG4gICAgICBzZWxlY3RlZFRhc2sucHJpb3JpdHkgPSB0YXNrUHJpb3JpdHk7XG5cbiAgICAgIHNhdmUoKTtcbiAgICAgIGV4aXRFZGl0TW9kZShwcm9qZWN0Q29udGFpbmVyKTtcbiAgICAgIHJlbmRlcigpO1xuICAgIH0pO1xuXG4gICAgLy9jYW5jZWwgZWRpdCBidXR0b25cbiAgICBjb25zdCBjYW5jZWxFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNidG4tY2FuY2VsLWVkaXQtdGFza1wiKTtcbiAgICBjYW5jZWxFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBleGl0RWRpdE1vZGUocHJvamVjdENvbnRhaW5lcik7XG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vL2RlbGV0ZSBpbmRpdmlkdWFsIHRhc2tcbnRhc2tzQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYnRuLXRhc2stZGVsZXRlXCIpKSB7XG4gICAgbGV0IGlkQXJyID0gZS50YXJnZXQuaWQuc3BsaXQoXCItXCIpO1xuICAgIGxldCBpZFRvRGVsZXRlID0gaWRBcnJbMV07XG5cbiAgICBjb25zdCBzZWxlY3RlZFByb2plY3QgPSBwcm9qZWN0cy5maW5kKFxuICAgICAgKHByb2plY3QpID0+IHByb2plY3QuaWQgPT09IHNlbGVjdGVkUHJvamVjdElkXG4gICAgKTtcbiAgICBzZWxlY3RlZFByb2plY3QudGFza3MgPSBzZWxlY3RlZFByb2plY3QudGFza3MuZmlsdGVyKFxuICAgICAgKHRhc2spID0+IHRhc2suaWQgIT09IGlkVG9EZWxldGVcbiAgICApO1xuXG4gICAgc2F2ZSgpO1xuICAgIHJlbmRlcigpO1xuICB9XG59KTtcblxuLy9kZWxldGUgc2VsZWN0ZWQgcHJvamVjdFxuZGVsZXRlUHJvamVjdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgcHJvamVjdHMgPSBwcm9qZWN0cy5maWx0ZXIoKHByb2plY3QpID0+IHByb2plY3QuaWQgIT09IHNlbGVjdGVkUHJvamVjdElkKTtcbiAgc2VsZWN0ZWRQcm9qZWN0SWQgPSBudWxsO1xuXG4gIHNhdmUoKTtcbiAgcmVuZGVyKCk7XG59KTtcblxuLy9hZGQgbmV3IHByb2plY3Rcbm5ld1Byb2plY3RGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IHByb2plY3ROYW1lID0gbmV3UHJvamVjdElucHV0LnZhbHVlO1xuICBjb25zdCBwcm9qZWN0ID0gY3JlYXRlUHJvamVjdChwcm9qZWN0TmFtZSk7XG5cbiAgbmV3UHJvamVjdElucHV0LnZhbHVlID0gbnVsbDtcbiAgcHJvamVjdHMucHVzaChwcm9qZWN0KTtcblxuICBzYXZlKCk7XG4gIHJlbmRlcigpO1xufSk7XG5cbi8vYWRkIG5ldyB0YXNrXG5uZXdUYXNrRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICBpZiAoc2VsZWN0ZWRQcm9qZWN0SWQgPT0gXCJudWxsXCIgfHwgc2VsZWN0ZWRQcm9qZWN0SWQgPT09IG51bGwpIHtcbiAgICBhbGVydChcIlBsZWFzZSBzZWxlY3QgYSBwcm9qZWN0IHRvIGFkZCB0aGUgbmV3IHRhc2suXCIpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHRhc2tOYW1lID0gbmV3VGFza0lucHV0LnZhbHVlO1xuICBjb25zdCB0YXNrRGF0ZSA9IG5ld1Rhc2tEYXRlLnZhbHVlO1xuICBjb25zdCB0YXNrTm90ZSA9IG5ld1Rhc2tOb3RlLnZhbHVlO1xuICBsZXQgdGFza1ByaW9yaXR5ID0gXCJcIjtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IG5ld1Rhc2tQcmlvcml0eS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChuZXdUYXNrUHJpb3JpdHlbaV0uY2hlY2tlZCkge1xuICAgICAgdGFza1ByaW9yaXR5ID0gbmV3VGFza1ByaW9yaXR5W2ldLnZhbHVlO1xuICAgIH1cbiAgfVxuXG4gIGlmICh0YXNrTmFtZSA9PSBudWxsIHx8IHRhc2tOYW1lID09PSBcIlwiKSByZXR1cm47XG5cbiAgY29uc3QgdGFzayA9IGNyZWF0ZVRhc2sodGFza05hbWUsIHRhc2tOb3RlLCB0YXNrRGF0ZSwgdGFza1ByaW9yaXR5KTtcbiAgbmV3VGFza0lucHV0LnZhbHVlID0gbnVsbDtcbiAgbmV3VGFza05vdGUudmFsdWUgPSBudWxsO1xuXG4gIGNvbnN0IHNlbGVjdGVkUHJvamVjdCA9IHByb2plY3RzLmZpbmQoXG4gICAgKHByb2plY3QpID0+IHByb2plY3QuaWQgPT09IHNlbGVjdGVkUHJvamVjdElkXG4gICk7XG4gIHNlbGVjdGVkUHJvamVjdC50YXNrcy5wdXNoKHRhc2spO1xuXG4gIHNhdmUoKTtcbiAgcmVuZGVyKCk7XG59KTtcblxuLy9zYXZlIHByb2plY3QgbGlzdHMgYW5kIHNlbGVjdGVkIHByb2plY3QgaWRcbmZ1bmN0aW9uIHNhdmUoKSB7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicHJvamVjdC5saXN0c1wiLCBKU09OLnN0cmluZ2lmeShwcm9qZWN0cykpO1xuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInByb2plY3Quc2VsZWN0ZWRMaXN0SWRcIiwgc2VsZWN0ZWRQcm9qZWN0SWQpO1xufVxuXG4vL3JlbmRlciBjb250ZW50XG5mdW5jdGlvbiByZW5kZXIoKSB7XG4gIGNsZWFyRWxlbWVudChwcm9qZWN0Q29udGFpbmVyKTtcbiAgcmVuZGVyUHJvamVjdExpc3RzKHByb2plY3RzLCBzZWxlY3RlZFByb2plY3RJZCwgcHJvamVjdENvbnRhaW5lcik7XG5cbiAgY29uc3Qgc2VsZWN0ZWRQcm9qZWN0ID0gcHJvamVjdHMuZmluZChcbiAgICAocHJvamVjdCkgPT4gcHJvamVjdC5pZCA9PT0gc2VsZWN0ZWRQcm9qZWN0SWRcbiAgKTtcblxuICAvL2NoZWNrIGlmIGhhdmluZyBzZWxlY3RlZCBwcm9qZWN0IHRvIGRpc3BsYXkgdGhlIHByb2plY3QgdG8gZG9cbiAgaWYgKHNlbGVjdGVkUHJvamVjdElkID09IFwibnVsbFwiIHx8IHNlbGVjdGVkUHJvamVjdElkID09PSBudWxsKSB7XG4gICAgcHJvamVjdERpc3BsYXlDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICB9IGVsc2Uge1xuICAgIHByb2plY3REaXNwbGF5Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuICAgIHByb2plY3RUaXRsZUVsZW1lbnQuaW5uZXJUZXh0ID0gc2VsZWN0ZWRQcm9qZWN0Lm5hbWU7XG5cbiAgICByZW5kZXJUYXNrQ291bnQoc2VsZWN0ZWRQcm9qZWN0LCB0YXNrc0NvdW50RWxlbWVudCk7XG4gICAgY2xlYXJFbGVtZW50KHRhc2tzQ29udGFpbmVyKTtcbiAgICByZW5kZXJUYXNrcyhzZWxlY3RlZFByb2plY3QsIHRhc2tzQ29udGFpbmVyKTtcbiAgfVxufVxuXG5yZW5kZXIoKTtcblxuIl0sIm5hbWVzIjpbInRhc2tUZW1wbGF0ZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJkZWxldGVQcm9qZWN0QnV0dG9uIiwicXVlcnlTZWxlY3RvciIsInRhc2tEZWxldGVCdXR0b24iLCJuZXdQcm9qZWN0QnV0dG9uIiwibmV3VGFza0J1dHRvbiIsImVkaXRUYXNrSW5wdXQiLCJlZGl0VGFza0RhdGUiLCJlZGl0VGFza05vdGUiLCJlZGl0VGFza1ByaW9yaXR5IiwiZ2V0RWxlbWVudHNCeU5hbWUiLCJjbGVhckVsZW1lbnQiLCJlbGVtZW50IiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwicmVuZGVyVGFza0NvdW50Iiwic2VsZWN0ZWRQcm9qZWN0IiwidGFza3NDb3VudEVsZW1lbnQiLCJpbmNvbXBsZXRlVGFza0NvdW50IiwidGFza3MiLCJmaWx0ZXIiLCJ0YXNrIiwiY29tcGxldGUiLCJsZW5ndGgiLCJ0YXNrU3RyaW5nIiwiaW5uZXJUZXh0IiwiZXhpdEVkaXRNb2RlIiwicHJvamVjdENvbnRhaW5lciIsImVkaXRDb250YWluZXIiLCJuZXdDb250YWluZXIiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJkaXNhYmxlZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYnRuIiwiY2hlY2tib3giLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImkiLCJ0eXBlIiwiZW5hYmxlTW9kZSIsIm5ld1Byb2plY3RGb3JtIiwibmV3UHJvamVjdElucHV0IiwicHJvamVjdERpc3BsYXlDb250YWluZXIiLCJwcm9qZWN0VGl0bGVFbGVtZW50IiwidGFza3NDb250YWluZXIiLCJuZXdUYXNrRm9ybSIsIm5ld1Rhc2tJbnB1dCIsIm5ld1Rhc2tEYXRlIiwibmV3VGFza05vdGUiLCJuZXdUYXNrUHJpb3JpdHkiLCJlZGl0VGFza0Zvcm0iLCJwcm9qZWN0cyIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJzZWxlY3RlZFByb2plY3RJZCIsImlkVG9FZGl0Iiwic2F2ZSIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJyZW5kZXIiLCJwcm9qZWN0IiwicHJvakVsZW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZGF0YXNldCIsInByb2pJZCIsImlkIiwibmFtZSIsImFwcGVuZENoaWxkIiwicmVuZGVyUHJvamVjdExpc3RzIiwiZmluZCIsInN0eWxlIiwiZGlzcGxheSIsInRhc2tFbGVtZW50IiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJ0YXNrUm93IiwicHJpb3JpdHkiLCJjaGVja2VkIiwibGFiZWwiLCJodG1sRm9yIiwiYXBwZW5kIiwiZHVlRGF0ZSIsIm5vdGVzIiwicmVuZGVyVGFza3MiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInRhcmdldCIsInRhZ05hbWUiLCJ0b0xvd2VyQ2FzZSIsImFsZXJ0IiwiY29udGFpbnMiLCJzcGxpdCIsInRvZ2dsZSIsImRpc2FibGVNb2RlIiwiaWRBcnIiLCJzZWxlY3RlZFRhc2siLCJ2YWx1ZSIsImVkaXRNb2RlIiwicHJldmVudERlZmF1bHQiLCJ0YXNrTmFtZSIsInRhc2tEYXRlIiwidGFza05vdGUiLCJ0YXNrUHJpb3JpdHkiLCJpZFRvRGVsZXRlIiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwicHVzaCIsImRhdGUiXSwic291cmNlUm9vdCI6IiJ9